# 运维自动化发布平台 (集成 Jenkins)

## 一、项目背景
当前企业内软件发布流程依赖 Jenkins，但存在以下问题：
- 各业务线发布流程不统一，缺乏统一的入口
- 需要频繁登录 Jenkins 手动触发任务，效率低
- 缺乏一站式管理和发布可视化，运维需人工追踪结果
- 部分业务需要灰度发布、回滚、权限控制，而 Jenkins Job 逻辑分散

因此需要开发一个基于 **Python + Jenkins API** 的 **运维自动化发布平台**，统一管理多个项目的构建、部署、回滚及发布流程。

---

## 二、项目目标
1. 提供统一的 Web 界面供研发/运维触发和管理项目发布。
2. 通过 Jenkins API 自动触发构建、部署流程，支持回滚、灰度发布。
3. 集成权限控制（RBAC），支持项目级角色管理。
4. 自动收集构建日志、部署状态，集中可视化展示。
5. 支持 API 化调用，供其他系统集成。

---

## 三、核心功能模块

### 1. 发布管理
- 支持项目列表展示，关联 Jenkins Job
- 一键触发构建 & 部署
- 查看实时构建日志（WebSocket 或轮询）
- 支持回滚历史版本、灰度发布

### 2. Jenkins 集成
- 使用 `python-jenkins` 或 `jenkinsapi` 调用 Jenkins REST API
- 自动获取构建参数、触发构建、查询状态
- 支持多 Jenkins 实例管理（多个环境）

### 3. 权限控制
- 基于 JWT 的登录认证
- RBAC 角色控制：管理员 / 运维 / 研发
- 项目级权限分配（哪些用户能发布哪个项目）

### 4. 构建 & 部署记录
- 持久化存储构建信息（时间、版本、操作者、状态）
- 提供发布历史查询
- 失败自动告警（钉钉/邮件）

### 5. API 集成
- 对外提供 REST API，供 CI/CD 其他系统调用
- 支持 Webhook 通知发布结果

---

## 四、系统架构
- **后端**：FastAPI (Python)
- **前端**：Vue.js (简易界面)
- **Jenkins API**：`python-jenkins` 调用 REST API
- **存储**：MySQL（项目、用户、发布记录）
- **消息通知**：钉钉/邮件
- **部署**：Docker + Docker Compose

---

## 五、非功能需求
- Web 界面需简洁易用，支持移动端查看状态
- 支持 LDAP/企业微信单点登录（可选）
- Docker 容器化部署，方便迁移
- 符合 RESTful API 设计规范

---

## 六、交付物
1. 完整项目代码（后端、前端、Dockerfile、部署脚本）
2. 数据库初始化脚本（MySQL）
3. API 文档（Swagger 自动生成）
4. 使用手册（如何添加项目、配置 Jenkins、触发发布）

---

## 七、开发周期（示例）
- 第 1 周：用户登录 & 权限模块，Jenkins API 接入
- 第 2 周：项目管理 & 构建触发接口
- 第 3 周：Web 界面集成，日志查看
- 第 4 周：历史记录、灰度发布、告警通知
- 第 5 周：测试与上线
